server:
  port: 8080
spring:
  application:
    name: "AtlasPlatform"
  devtools:
    add-properties: false
  # Configuración R2DBC para conexión reactiva a MySQL
  r2dbc:
    url: r2dbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:atlas}?useUnicode=true&characterEncoding=UTF-8
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:123456}
    pool:
      enabled: true
      initial-size: 12
      max-size: 15
      max-idle-time: 30m
      validation-query: SELECT 1
  # Configuración Flyway para migraciones (usa JDBC ya que Flyway no soporta R2DBC directamente)
  flyway:
    enabled: true
    url: jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:atlas}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
    user: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:123456}
    locations: classpath:db/migration
    baseline-on-migrate: true
    baseline-version: 0
    validate-on-migrate: false  # Desactivado temporalmente por conflicto checksum en V21
    out-of-order: false
    clean-disabled: true
  # Configuración de correo electrónico (bajo spring.mail para auto-config de Spring Boot)
  mail:
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:kodianteach@gmail.com}
    password: ${MAIL_PASSWORD:fchn spwr vhjx kmfs}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connection-timeout: 5000
          timeout: 3000
          write-timeout: 5000
    default-encoding: UTF-8
# Configuración de notificaciones
notification:
  enabled: ${NOTIFICATION_ENABLED:true}
  from-email: ${NOTIFICATION_FROM_EMAIL:noreply@atlas-platform.com}
  from-name: ${NOTIFICATION_FROM_NAME:Atlas Platform}

# URL del Frontend para links en correos
app:
  frontend-url: ${FRONTEND_URL:http://localhost:4200}

# Crypto configuration for EdDSA key encryption
atlas:
  crypto:
    master-key: ${CRYPTO_MASTER_KEY:DefaultDevMasterKey256bit!}
  branding:
    max-logo-size-bytes: ${BRANDING_MAX_LOGO_SIZE:2097152}
    allowed-content-types: image/png,image/jpeg

# Propiedades personalizadas para el adaptador R2DBC
adapters:
  r2dbc:
    host: ${DB_HOST:localhost}
    port: ${DB_PORT:3306}
    database: ${DB_NAME:atlas_platform}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:123456}

management:
  endpoints:
    web:
      exposure:
        include: "health,prometheus"
  endpoint:
    health:
      probes:
        enabled: true
cors:
  allowed-origins: "http://localhost:4200,http://localhost:8080"

# Configuración JWT
jwt:
  secret: ${JWT_SECRET:MiClaveSecretaMuySeguraParaJWTDeAlMenos256BitsParaHS256AlgorithmAtlas2026}
  access-token-expiration: ${JWT_ACCESS_EXPIRATION:3600000}
  refresh-token-expiration: ${JWT_REFRESH_EXPIRATION:86400000}
  issuer: ${JWT_ISSUER:atlas-platform}

# Configuración Swagger/OpenAPI
springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html
    operations-sorter: method
    tags-sorter: alpha
    display-request-duration: true
  cache:
    disabled: true

# Logging
logging:
  level:
    co.com.atlas.api.config: DEBUG
    co.com.atlas.jwt: DEBUG


